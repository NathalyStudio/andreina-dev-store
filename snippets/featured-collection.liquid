{% comment %} 
 Renders a collection on Cart drawer 

 Usage:
  {% render 'featured-collection' title: settings.title, heading_size: settings: heading_size,
  heading_color: settings: heading_color, collection: settings.collection,
  products_to_show: settings.products_to_show,
  full_width: settings.full_width, enable_desktop_slider: settings.enable_desktop_slider,
  image_ratio: settings.image_ratio, show_secondary_image: settings.show_secondary_image, 
  show_vendor: settings.show_vendor, show_rating: settings.show_rating,  columns_mobile: settings.columns_mobile,  swipe_on_mobile: settings. swipe_on_mobile %}
{% endcomment %}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'component-rte.css' | asset_url | stylesheet_tag }}

<link rel="stylesheet" href="{{ 'component-slider.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'template-collection.css' | asset_url }}" media="print" onload="this.media='all'">

<noscript>{{ 'component-slider.css' | asset_url | stylesheet_tag }}</noscript>
<noscript>{{ 'template-collection.css' | asset_url | stylesheet_tag }}</noscript>

{%- style -%}
  .headings-wrapper {
    display: flex;
    justify-content: space-between;
  }
{%- endstyle -%}

{%- liquid
  assign products_to_display = settings.collection.all_products_count

  if settings.collection.all_products_count > settings.products_to_show
    assign products_to_display = settings.products_to_show
    assign more_in_collection = true
  endif

  assign columns_mobile_int = settings.columns_mobile | plus: 0
  assign show_mobile_slider = false
  if settings.swipe_on_mobile and products_to_display > columns_mobile_int
    assign show_mobile_slider = true
  endif


-%}

<div class="color-{{ settings.color_scheme }} isolate gradient">
  <div class="collection">
    <div class="headings-wrapper">
      <div class="collection__title title-wrapper--no-top-margin title-wrapper--no-bottom-margin {% if show_desktop_slider %} collection__title--desktop-slider{% endif %}">
      {%- if settings.title != blank -%}
        <h2 class="title font-body-bold {{ settings.heading_size }}" style="color:{{ settings.heading_color }};">{{ settings.title | escape }}</h2>
      {%- endif -%}
    </div>
  </div>

    <slider-component class="slider-mobile-gutter{% if settings.full_width %} slider-component-full-width{% endif %}{% if show_desktop_slider %} slider-component-desktop{% endif %}">
      <ul
        id="Slider-{{ section.id }}"
        class="grid product-grid contains-card contains-card--product grid--3-col-desktop-col-desktop {% if settings.collection == blank %} grid--2-col-tablet-down{% else %} grid--{{ settings.columns_mobile }}-col-tablet-down{% endif %}{% if show_mobile_slider or show_desktop_slider %} slider{% if show_desktop_slider %} slider--desktop{% endif %}{% if show_mobile_slider %} slider--tablet grid--peek{% endif %}{% endif %}"
        role="list"
        aria-label="{{ 'general.slider.name' | t }}"
      >
        {%- for product in settings.collection.products limit: settings.products_to_show -%}
          <li
            id="Slide-{{ section.id }}-{{ forloop.index }}"
            class="grid__item{% if show_mobile_slider or show_desktop_slider %} slider__slide{% endif %}"
          >
            {% render 'card-product',
              card_product: product,
              media_aspect_ratio: settings.image_ratio,
              show_secondary_image: settings.show_secondary_image,
              show_vendor: settings.show_vendor,
              show_rating: settings.show_rating,
              section_id: section.id
            %}
          </li>
        {%- else -%}
          {%- for i in (1..4) -%}
            <li class="grid__item">
              {% render 'card-product', show_vendor: settings.show_vendor %}
            </li>
          {%- endfor -%}
        {%- endfor -%}
      </ul>
      {%- if show_mobile_slider or show_desktop_slider -%}
        <div class="slider-buttons no-js-hidden">
          <button
            type="button"
            class="slider-button slider-button--prev"
            name="previous"
            aria-label="{{ 'general.slider.previous_slide' | t }}"
            aria-controls="Slider-{{ section.id }}"
          >
            {% render 'icon-caret' %}
          </button>
          <div class="slider-counter caption">
            <span class="slider-counter--current">1</span>
            <span aria-hidden="true"> / </span>
            <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
            <span class="slider-counter--total">{{ products_to_display }}</span>
          </div>
          <button
            type="button"
            class="slider-button slider-button--next"
            name="next"
            aria-label="{{ 'general.slider.next_slide' | t }}"
            aria-controls="Slider-{{ section.id }}"
          >
            {% render 'icon-caret' %}
          </button>
        </div>
      {%- endif -%}
    </slider-component>
  </div>
</div>
